---
layout: post
title: "옵시디언(Obsidian)을 세팅해보자 - git 활용한 아이폰 동기화까지"
tags: [생산성]
comments: True
toc: true
---

**요약**

```
  - 옵시디언을 설치하고 vault, 노트 링크, 그래프 뷰 등 기본 기능을 살펴본다
  - Git 플러그인으로 데스크탑 동기화를 설정하고, aShell을 활용해 아이폰에서도 SSH 기반 git 동기화를 구현한다
  - iOS 단축어를 연동하여 옵시디언 앱의 열기/닫기 시 자동 pull/push가 되도록 설정한다
```

# 개요

나만의 **지식 데이터베이스**를 구축하기 위해 옵시디언을 세팅하려 한다. 

최근 [공식 CLI](https://help.obsidian.md/cli)를 지원한다고 하여 다른 메모 앱보다 에이전트에 친화적이라는 생각이 들기 때문이다.  

기존에 사용하던 어플리케이션의 불편함을 짚어보자면,  

| 앱 | 문제점 |
| --- | --- |
| 노션 | 무겁고 군더더기가 너무 많음 |
| iOS 메모앱 | 포맷팅이 불편하고 너무 가벼워 메모가 휘발적임 |

(가만 생각해보니 이제껏 나만의 지식 데이터베이스의 역할을 해주던 건 "카카오톡 나에게 보내기" 기능이었다)

# 시작

![image](/images/obsidian_00.png){: width="80%"}

[Obsidian](https://obsidian.md/) 공홈에서 MacOS 앱을 받아 설치했다. 오른편의 Graph View가 눈에 띈다.

`vault`는 md 파일들이 저장되는 root 폴더를 가리킨다. 

`link`는 내외부 리소스와 연결해주는 방식이고, `importer`는 외부의 리소스를 마이그레이션해올 수 있는 플러그인이다.  

![image](/images/obsidian_01.png){: width="80%"}

새 노트를 생성한 다음 내용을 작성해보았다. 

이때 특정 키워드를 `[[이런 식]]`으로 감싸주면, 그 키워드를 제목으로 하는 새 노트를 작성할 수 있는 링크가 생성된다. 

이렇게 노트끼리 서로 참조할 수 있다.  

![image](/images/obsidian_02.png){: width="80%"}

그래프 뷰를 통해 노트 간 관계를 확인할 수 있다. 또 `#태그` 형식으로 태그 기능을 사용할 수 있다.  

추가로 비교적 최근에 공식 도입된 *base* 기능은 노션의 데이터베이스와 유사하게 사용할 수 있다고 하는데 ... 

슥 둘러 봤을 땐 index 기능에 더 가까운 것 같다. 

아직은 입문 단계니까 base 는 패스.  

# git 연동  

Obsidian Sync 는 유료 기능이기 때문에, git을 활용하여 무료로 데이터를 동기화할 수 있다.  

1. github 에 private repository 를 생성한다.  

2. 옵시디언의 설정 > Community Plugins > Git 설치한다.

3. vault 가 위치한 경로로 가서 git init 해준다.  
- 왼쪽 하단 vault 이름을 클릭하면 manage vaults 가 뜨는데, 거기서 로컬 파일 시스템 내 어디에 위치하는지 경로가 보인다.
- 나의 경우, /Users/`<내 이름>`/Documents 에 있었음  

    ![image](/images/obsidian_03.png){: width="80%"}

4. git 플러그인 설정에서 자동 sync 모드를 켜준다.  
- 옵시디언 화면에서 git commit/push 등 동작을 버튼으로 수행할 수 있게 된다.

참고로 passphrase 를 입력하라는 창이 계속 떴었는데, vault 폴더에서 .git/config 의 url 정보를 아래와 같이 변경하니 바로 push 할 수 있게 되었다.  

```
# 수정 전
[remote "origin"]
	url = git@github.com:<계정명>/<레포 이름>.git

# 수정 후
[remote "origin"]
	url = https://github.com/<계정명>/<레포 이름>.git
```

처음에 ssh 인증 방식을 사용했기 때문에 키에 대한 비밀번호를 요구했던 것 같다. 

# 아이폰에서의 연동  

이전에는 obsidian-git 플러그인이 iOS 를 지원하지 않아, 

*working copy* 등 다른 git 클라이언트 앱을 통해 동기화를 해야 했던 것으로 보인다.   


2026년 2월 현재는 어떨까.  

[obsidian-git 공식 리드미](https://github.com/Vinzent03/obsidian-git?tab=readme-ov-file#-mobile-support-%EF%B8%8F--experimental)에 따르면 모바일 환경에서는 메모리 이슈 등 동작이 불안정하다는 것을 경고하고 있다. (그냥 안 된다고 봐야 할 듯)

선택지는 두 개 정도로 좁혀진다.  
- Gitsync (repo 한 개까지 무료라는 얘길 봄) 같은 git 클라앱을 사용하거나,  
- iSH 같은 터미널 앱을 깔아 git 명령어를 입력하는 것.

일단 자동 push 기능은 아이폰의 단축어로 구현해야 할 텐데, iSH 와 단축어 기능을 연동하기 어렵다는 논의가 보인다. - [Can we run Shortcuts by a command ?](https://github.com/ish-app/ish/issues/1289) 

반면 [aShell 은 될 것 같은 느낌](https://github.com/holzschu/a-shell?tab=readme-ov-file#shortcuts).  

우선 ... **aShell 로 동기화 도전!**

참고한 포럼 - [[Mobile] Automatic sync with GitHub on iOS (for free) via a-shell](https://forum.obsidian.md/t/mobile-automatic-sync-with-github-on-ios-for-free-via-a-shell/46150?page=2)

## 1. 앱 설치  

(1) 앱스토어에서 Obsidian 앱을 설치한다 - create a new vault 로 진행 (이름은 Temp)

(2) 앱스토에서 aShell mini 앱을 설치한다

(3) aShell 에서 `pickFolder` 명령어 입력 > 내 아이폰에서 Obsidian 폴더를 찾아 선택해준다

<div style="display:flex; gap:8px;">
  <img src="/images/obsidian_04.png" width="45%">
  <img src="/images/obsidian_05.png" width="45%">
</div>

1번 과정에서 설정한 Temp 가 보이는 상태  

## 2. SSH 키 등록

aShell 에서 SSH 키를 생성

```
ssh-keygen -t ed25519 -C "<이메일>@gmail.com"
```

~home 으로 가서 .ssh/ 위치의 id_ed25519.pub 를 출력한다

```
head id_ed25519.pub
```

출력된 내용을 복사해서 github 의 ssh 관리탭에 키를 추가해준다.

## 3. github 동기화

다시 아까의 옵시디언 폴더로 돌아간다.

앞서 만든 vault 폴더명을 `ios-vault` 로 이름을 변경해준다음 cd ios-vault 했다.  

```
lg2 init .
lg2 remote add origin git@github.com:USERNAME/REPO-NAME.git
lg2 pull origin
```

host/key pair 를 등록할 거냐는 애스크가 뜰 텐데 y 를 입력하면 된다.

![image](/images/obsidian_06.png){: width="80%"}

**git 으로부터 데이터가 불러와졌다!!**

![image](/images/obsidian_07.jpeg){: width="40%"}

마지막으로 세팅. 출력된 내용 중에서 *Consider running* 다음으로 나온 명령어들을 붙여 넣고 실행한다. 

```
lg2 config user.name "계정명"
lg2 config user.email "이메일 주소"
```

이렇게 git 사용을 위한 user 정보 설정까지 마친다.  

## 4. push 테스트

아이폰에서 수정한 내역을 push 하고, 맥 데스크탑앱에서 pull 하는 간단한 실험을 진행한다.

(브랜치명이 master 로 되어 있어서 중간에 엄청 삽질하고, 갑자기 not a valid reference 'main' 같은 에러가 뜨면서 push가 안 되기도 했음)  

(1) 아이폰 obsidian 앱에서 수정

(2) (제발 브랜치명 확인하기) 

```
lg2 checkout main
```

(3) lg2 status 확인 후, 
```
lg2 add . & lg2 commit -m 'init commit from iPhone'
```

(4) push 한다  
```
lg2 push origin main
```
여기서 not a valid reference 'main' 에러가 뜨기도 했는데 `lg2 push origin refs/heads/main` 이렇게 명시했을 때 성공

(5) 웹에서 push 됐는지 확인하고, 데스크탑에서 pull 버튼을 눌러주면 ...

![image](/images/obsidian_08.png){: width="80%"}

성공 ㅠㅠ

## 5. 단축어 설정  

단축어 설정을 하려면 jump 명령어로 obsidian 폴더에 접근할 수 있어야 한다.  

showmarks 를 입력해서 출력 결과를 보면 북마크명이 obsidian 이 아니라 Documents 라는 이름으로 되어 있는데, 이걸 이렇게 바꿔준다. 

```
renamemark Documents obsidian
```

이제 `jump obsidian` 명령어로 폴더로 이동할 수 있다. (iOS의 aShell은 bookmark 기반 접근을 이용하기 때문이라고 함)

#### 자동 pull

(1) 아이폰의 단축어 앱에서 '자동화' 탭으로 간다

(2) 새로운 개인용 자동화를 선택하여 "앱" 을 클릭한다

![image](/images/obsidian_09.png){: width="40%"}
- Obsidian 앱이 열릴 때를 조건으로 한다

(3) 동작에서 새로운 단축어를 생성, a-shell mini 를 선택해 "명령 실행" 을 선택한다

(4) 셸 명령어는 차례대로 아래와 같이 설정

```
jump obsidian
cd <vault 이름>
lg2 pull origin
```

(5) obsidian 앱을 열 때마다 단축어 실행 팝업이 뜬다

![image](/images/obsidian_10.png){: width="40%"}



#### 자동 push

(1) 똑같이 아이폰 단축어에서 자동화를 추가하여 Obsidian 이 닫힐 때를 조건으로 한다

(2) 동작에서 새로운 단축어를 생성, 이번에는 commit 일시를 기록하기 위해 변수를 설정해준다
- 스크립트 하기 > 변수 설정 > 현재 날짜

(3) a-shell mini 를 선택해 "명령 실행" 으로 아래와 같이 설정  

```
jump obsidian
cd <vault 이름>
lg2 add .
lg2 commit -m "commit from iPhone <시간 변수>"
lg2 push origin refs/heads/main
```

![image](/images/obsidian_11.png){: width="80%"}

실제 commit 메세지도 잘 설정된 것을 확인하였다.

# 정리  

오늘 obsidian 을 처음 입문하면서, 켠 김에 모바일 자동 동기화까지 완료했다. 

obsidian 유료 서비스 쓰기 싫다고 돌고 돌아 온 느낌이 있지만 ㅋㅋㅋ 

이 과정에서 상당히 많이 배울 수 있었다. 특히 폰으로 리눅스 만져보는 건 완전히 새로운 경험!

그 다음으로는 obsidian 데이터베이스를 RAG 으로 긁어와 LLM 개인비서가 참고할 수 있게 하는 시스템을 만들어 보고 싶은데. 

아니면 LLM 이 자동으로 금융 뉴스 스크랩핑 해서 obsidian 에 데이터 쌓고 참조하게 만드는 것도 좋겠다.

하여튼, 그 프로젝트를 실행하기 전까지 obsidian과 친해지는 시간을 충분히 가져야겠다. 